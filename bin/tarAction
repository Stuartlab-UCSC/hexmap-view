#!/bin/bash
# tar the contents of hexagram and scp to dev
# or untar the contents of a tar ball

ACTION=$1
TARGET=$2

#echo ACTION, TARGET: $ACTION, $TARGET

if [ -z ${TARGET} ]; then
    TARGET=www
fi

if [ $TARGET == 'www' ]; then
    echo everything except docs and tests/pyUnittest
    TARRED=www.tar
    TAR_FILES=" \
        calc/*py \
        www/client \
        www/lib \
        www/public/*svg \
        www/public/*ico \
        www/public/*png \
        www/public/icons \
        www/public/images \
        www/public/*js \
        www/public/*gif \
        www/server/*js \
        www/server/*py \
        www/package.json \
        "
elif [ $TARGET == 'hub' ]; then
    echo the hub files
    cd hub
    TARRED=hub.tar
    TAR_FILES=" \
        *py \
        *sh \
        "
elif [ $TARGET == 'bin' ]; then
    echo the bin/config files
    TARRED=bin.tar
    TAR_FILES=" \
        bin/run_server \
        bin/tarAction \
        config/* \
        "
elif [ $TARGET == 'docs' ]; then
    echo the docs in www/public
    TARRED=docs.tar
    TAR_FILES=" \
        www/public/createMap \
        www/public/query \
        www/public/useCases \
        "
elif [ $TARGET == 'tests' ]; then
    echo the tests in tests/pyUnittest
    TARRED=tests.tar
    TAR_FILES=" \
        tests/pyUnittest/README \
        tests/pyUnittest/exp \
        tests/pyUnittest/in \
        tests/pyUnittest/run* \
        tests/pyUnittest/sort_files \
        tests/pyUnittest/*py \
        "
fi

if [ $ACTION == 'maketar' ]
    then
    echo 'tarring to' $TARRED
    rm $TARRED
    tar -cf $TARRED $TAR_FILES
    ls -l $TARRED
    scp $TARRED juggernaut:dev

elif [ $ACTION == 'xtar' ]; then
    echo 'cleaning directories'
    rm -rf $TAR_FILES
    echo 'untarring'
    tar -xf /cluster/home/swat/dev/$TARRED
    echo 'xtar done'

else
    echo Invalid tar action: $ACTION
    echo Exiting
fi
