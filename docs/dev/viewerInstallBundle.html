
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>View Server Install: production &#8212; TumorMap Developer Documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Git Quick Start" href="repository.html" />
    <link rel="prev" title="View Server Install: development" href="viewerInstallDev.html" /> 
  </head>
  <body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">TumorMap Developer Documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="viewerInstallDev.html" title="View Server Install: development"
             accesskey="P">previous</a> |
          <a href="repository.html" title="Git Quick Start"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="view-server-install-production">
<h1>View Server Install: production<a class="headerlink" href="#view-server-install-production" title="Permalink to this headline">¶</a></h1>
<p>This assumes you already have a development installation somewhere else to
make the deployment bundle to be installed.</p>
<p>These steps are done on the <em>target</em> machine unless otherwise stated.</p>
<p>Note these version numbers:</p>
<p><em>node</em> : v8.11
<em>mongodb</em> : v3.4</p>
<div class="section" id="make-directories">
<h2>Make directories<a class="headerlink" href="#make-directories" title="Permalink to this headline">¶</a></h2>
<p>Make the application and data directories. The data directory does not need to
be in any particular place in relation to the app directory.</p>
<p><em>my-app</em> is your root directory for development of the application</p>
<p><em>my-data</em> is the root directory of the user data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
<span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
<span class="n">mkdir</span> <span class="n">db</span> <span class="n">log</span> <span class="n">node_modules</span> <span class="n">packages</span> <span class="n">pid</span> <span class="n">www</span>

<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">my</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">featureSpace</span> <span class="n">my</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">view</span>
</pre></div>
</div>
</div>
<div class="section" id="install-node">
<h2>Install node<a class="headerlink" href="#install-node" title="Permalink to this headline">¶</a></h2>
<p>Find the version of node to use with the meteor version being used and install
that. The distribution downloads are at:</p>
<p><a class="reference external" href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p>
<p>Install as follows, renaming the resulting directory. Something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span><span class="o">/</span><span class="n">packages</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nodejs</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">v8</span><span class="o">.</span><span class="mf">11.3</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v8</span><span class="o">.</span><span class="mf">11.3</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">tar</span> <span class="n">xf</span> <span class="n">node</span><span class="o">-</span><span class="n">v8</span><span class="o">.</span><span class="mf">11.3</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="n">mv</span> <span class="n">node</span><span class="o">-</span><span class="n">v8</span><span class="o">.</span><span class="mf">11.3</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span> <span class="n">node</span>
</pre></div>
</div>
</div>
<div class="section" id="install-mongodb">
<h2>Install mongodb<a class="headerlink" href="#install-mongodb" title="Permalink to this headline">¶</a></h2>
<p>Find the version of mongodb to use with the meteor version being used and
install that. The distribution downloads are at:</p>
<p><a class="reference external" href="https://www.mongodb.com/download-center#community">https://www.mongodb.com/download-center#community</a></p>
<p>Click on your platform to find a list of versions and select the one for your</p>
<p>If there is more than one option, find the option for your OS version.</p>
<p>If you need to find your redhat/centos version use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">hostnamectl</span>
</pre></div>
</div>
<p>If the current mongo version is not the same as the one being used by meteor,
you need to find the appropriate image to download. Otherwise download using
the instructions on the page continue with <em>Rename the directory</em>.</p>
<div class="section" id="download-an-earlier-version">
<h3>Download an earlier version<a class="headerlink" href="#download-an-earlier-version" title="Permalink to this headline">¶</a></h3>
<p>Note the filename shown for the current version, something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">fastdl</span><span class="o">.</span><span class="n">mongodb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">mongodb</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">rhel70</span><span class="o">-</span><span class="mf">4.0</span><span class="o">.</span><span class="mf">0.</span><span class="n">tgz</span>
</pre></div>
</div>
<p>Click on <em>All Version Binaries</em>.</p>
<p>Find the filename similar to the one you noted above, looking for the most
recent point release.</p>
<p>For example on redhat/centos v7 mongodb v3.4:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>wget http://downloads.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.4.16.tgz?_ga=2.137449328.1707226230.1531432538-1246595538.1531432538
tar xf *mongodb*
</pre></div>
</div>
</div>
<div class="section" id="rename-the-directory">
<h3>Rename the directory<a class="headerlink" href="#rename-the-directory" title="Permalink to this headline">¶</a></h3>
<p>Rename the directory resulting from untarring with something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">rhel70</span><span class="o">-</span><span class="mf">3.4</span><span class="o">.</span><span class="mi">16</span> <span class="n">mongodb</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-http-proxy">
<h2>Install HTTP Proxy<a class="headerlink" href="#install-http-proxy" title="Permalink to this headline">¶</a></h2>
<p>Install a node module needed for the http proxies:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
<span class="n">npm</span> <span class="n">install</span> <span class="n">http</span><span class="o">-</span><span class="n">proxy</span>
</pre></div>
</div>
</div>
<div class="section" id="install-server-scripts">
<h2>Install server scripts<a class="headerlink" href="#install-server-scripts" title="Permalink to this headline">¶</a></h2>
<p>Here we use <em>dev</em> to refer to a development installation on the development
machine that builds the <em>bundle</em> to install on a <em>target</em>.</p>
<p>On dev copy the scripts to the target:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
<span class="n">tar</span> <span class="n">cf</span> <span class="n">config</span><span class="o">.</span><span class="n">tar</span> <span class="nb">bin</span> <span class="n">config</span>
<span class="n">scp</span> <span class="n">config</span><span class="o">.</span><span class="n">tar</span> <span class="n">my</span><span class="o">-</span><span class="n">target</span><span class="o">-</span><span class="n">host</span><span class="p">:</span><span class="n">my</span><span class="o">-</span><span class="n">target</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
</pre></div>
</div>
<p>On the target install the scripts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="nb">bin</span> <span class="n">config</span>
<span class="n">tar</span> <span class="n">xf</span> <span class="n">config</span><span class="o">.</span><span class="n">tar</span>
</pre></div>
</div>
</div>
<div class="section" id="configure">
<h2>Configure<a class="headerlink" href="#configure" title="Permalink to this headline">¶</a></h2>
<p>Build a configuration file similar to my-app/hexagram/config/prod.
This file may be put anywhere except in directories under my-app/hexagram
because those are overwritten during install.</p>
</div>
<div class="section" id="set-environment-variables">
<h2>Set environment variables<a class="headerlink" href="#set-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Define the full path of your application server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">HEXMAP</span><span class="o">=/</span><span class="n">full</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">my</span><span class="o">-</span><span class="n">app</span><span class="o">/</span><span class="n">hexagram</span>
</pre></div>
</div>
<p>Define the full path of your server configuration file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">HEX_VIEWER_CONFIG</span><span class="o">=/</span><span class="n">full</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">my</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
<p>Include this in your PATH:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$HEXMAP/packages/node/bin:$HEXMAP/packages/mongodb/bin:$PATH
</pre></div>
</div>
</div>
<div class="section" id="install-server-code">
<h2>Install server code<a class="headerlink" href="#install-server-code" title="Permalink to this headline">¶</a></h2>
<p>Here we use <em>dev</em> to refer to a development installation on the development
machine that builds the <em>bundle</em> to install on a <em>target</em>.</p>
<p>On dev build the bundle and copy it to the target:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $HEXMAP
deployWww
</pre></div>
</div>
<p>On the target install the bundle:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $HEXMAP
installWww
</pre></div>
</div>
</div>
<div class="section" id="start-server">
<h2>Start server<a class="headerlink" href="#start-server" title="Permalink to this headline">¶</a></h2>
<p>Start these servers if using https:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $HEXMAP
start http
start https
</pre></div>
</div>
<p>Start the database and www servers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $HEXMAP
start db
start www
</pre></div>
</div>
<p>Each server has a log file with an extension of: ‘.log’.</p>
<p>If you are running on port 80 or 443, you will need to run the start and stop
http(s) scripts as root after defining HEXMAP and HEX_VIEWER_CONFIG.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="internalWebApi.html">Internal Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="computeInstall.html">Data Server Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewerInstallDev.html">View Server Install: development</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">View Server Install: production</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository.html">Git Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">This Document</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="viewerInstallDev.html" title="View Server Install: development"
              >previous</a> |
            <a href="repository.html" title="Git Quick Start"
              >next</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/viewerInstallBundle.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, UCSC TumorMap developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>